# Privacy Policy - UBF Auth API

**Last updated:** February 9, 2026

## Overview

UBF Auth API is a centralized authentication and authorization service developed for Utbildningsförvaltningen Göteborgs Stad (UBF). It verifies user identity and manages access permissions for internal Chrome extensions and tools.

## What data is collected?

The service collects the following information:

**From Google Workspace:**
- Email address (used as user identifier)
- OAuth token metadata (expiration, audience, scope)

**From Google Admin SDK:**
- Google Groups membership status (admin groups and school groups)

**Generated by the service:**
- Login timestamps
- IP address and user-agent at login
- Service-specific permissions (admin status, school access)

## How is the data used?

Data is used **only** for:
- Verifying user identity via Google OAuth
- Determining access permissions based on Google Groups membership
- Logging login activity for security monitoring
- Caching permissions to reduce API calls

## Where is data stored?

| Storage | Data | Retention |
|---------|------|-----------|
| **Firestore** | User permissions per service | Updated every 4 hours |
| **Firestore** | Login logs (email, IP, user-agent, timestamp) | Until manually deleted |
| **In-memory cache** | Group membership status | 5 minutes |
| **Google Secret Manager** | Service account credentials | Permanent |

No data is stored locally on the user's device by this service.

## Third parties

The service communicates with the following Google services:

| Service | Purpose | Data sent |
|---------|---------|-----------|
| **Google OAuth** | Token verification | Access token |
| **Google Admin SDK** | Group membership checks | Email address, group email |
| **Google Cloud Firestore** | Permission storage | Email, permissions, login metadata |
| **Google Secret Manager** | Credential management | None (read-only) |

All communication is encrypted via HTTPS.

## Permissions and scopes

The service requires the following OAuth scopes from users:
- **openid:** Basic authentication
- **email:** To identify the user

Server-side (Domain-Wide Delegation):
- **admin.directory.group.member.readonly:** To check Google Groups membership

## Data sharing

- User data is **never** shared with external third parties
- Data is only accessible to authorized administrators within Utbildningsförvaltningen
- Server-to-server API access requires a valid API key

## Data retention

- Permission cache in Firestore is refreshed every 4 hours
- In-memory group membership cache expires after 5 minutes
- Login logs are stored indefinitely for security audit purposes

## Security measures

- All traffic encrypted via HTTPS (Cloud Run enforced)
- Rate limiting on all endpoints
- Input validation on all user-provided data
- HTTP security headers via Helmet
- API keys for server-to-server communication
- Service account credentials stored in Secret Manager

## Contact

For questions about this privacy policy, contact Utbildningsförvaltningen Göteborgs Stad.

## Changes

We may update this policy as needed. Changes will be published on this page.

---

**Developer:** Utbildningsförvaltningen Göteborgs Stad  
**Support:** [ServiceNow - UBF](https://intraservice.service-now.com/ubf)
